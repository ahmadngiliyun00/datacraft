{% extends 'base.html' %} {% block content %}
<div class="container-xxl flex-grow-1 container-p-y">
	<div class="fw-bold mb-4">
		<span class="text-muted fw-light">DataCraft / </span>
		<span class="text-muted fw-light">Pemodelan Data / </span>
		<span class="color-custom-secondary">{{ title }}</span>
	</div>

	{% with messages = get_flashed_messages(with_categories=true) %} {% if
	messages %} {% for category, message in messages %}
	<div
		class="alert alert-{{ category }} alert-dismissible fade show"
		role="alert">
		{{ message }}
		<button
			type="button"
			class="btn-close"
			data-bs-dismiss="alert"
			aria-label="Close"></button>
	</div>
	{% endfor %} {% endif %} {% endwith %}

	<div class="row">
		<div class="col-12 mb-4 order-0">
			<!-- Informasi Model -->
			<div class="card mb-4">
				<h5 class="card-header text-primary">
					Hasil Evaluasi Model Support Vector Machine (SVM)
				</h5>
				<div class="card-body">
					<ul class="list-unstyled">
						<li>
							<strong>Akurasi Model:</strong> 
							{% if accuracy %}
							{{ "%.2f"|format(accuracy * 100) }}%
							{% else %}
							<span class="text-danger">Tidak tersedia</span>
							{% endif %}
						</li>
					</ul>
					<h6 class="mt-4 text-secondary">Laporan Klasifikasi:</h6>
					{% if report %}
					<div class="table-responsive mt-3">
						<table class="table table-striped table-hover">
							<thead class="table-light">
								<tr>
									<th>Kelas</th>
									<th>Presisi</th>
									<th>Recall</th>
									<th>F1-Score</th>
									<th>Support</th>
								</tr>
							</thead>
							<tbody>
								{% for label, metrics in report.items() %} {% if label not in
								['accuracy', 'macro avg', 'weighted avg'] %}
								<tr>
									<td class="fw-bold text-center">{{ label }}</td>
									<td class="text-center">{{ "%.2f"|format(metrics['precision'] * 100) }}%</td>
									<td class="text-center">{{ "%.2f"|format(metrics['recall'] * 100) }}%</td>
									<td class="text-center">{{ "%.2f"|format(metrics['f1-score'] * 100) }}%</td>
									<td class="text-center">{{ metrics['support'] }}</td>
								</tr>
								{% endif %} {% endfor %}
							</tbody>
						</table>
					</div>
					<div class="table-responsive mt-3">
						<table class="table table-striped table-hover">
							<thead class="table-light">
								<tr>
									<th class="text-start">Kelas</th>
									<th class="text-start">Presisi</th>
									<th class="text-start">Recall</th>
									<th class="text-start">F1-Score</th>
									<th class="text-start">Support</th>
								</tr>
							</thead>
							<tbody>
								{% for label, metrics in report.items() %} {% if label not in
								['accuracy', 'macro avg', 'weighted avg'] %}
								<tr>
									<td class="fw-bold text-start">{{ label }}</td>
									<td class="text-start">{{ metrics['precision'] }}</td>
									<td class="text-start">{{ metrics['recall'] }}</td>
									<td class="text-start">{{ metrics['f1-score'] }}</td>
									<td class="text-start">{{ metrics['support'] }}</td>
								</tr>
								{% endif %} {% endfor %}
							</tbody>
						</table>
					</div>
					{% else %}
					<p class="text-danger">Tidak ada data evaluasi yang tersedia.</p>
					{% endif %}
				</div>
			</div>

			<!-- Confusion Matrix -->
			<div class="card mb-4">
				<h5 class="card-header">Confusion Matrix</h5>
				<div class="card-body text-center">
					{% if cm_path %}
          <img
            src="{{ cm_path }}"
            alt="Confusion Matrix"
            class="img-fluid" />
					{% else %}
					<p>Confusion Matrix tidak tersedia.</p>
					{% endif %}
				</div>
			</div>

			<!-- Tombol Navigasi -->
			<div class="card">
				<div class="card-body">
					<div class="d-flex justify-content-between align-items-center">
						<div>
							<a
								href="{{ url_for('split_dataset') }}"
								class="btn btn-warning btn-sm">
								<i class="bx bx-arrow-back"></i>
								&nbsp; Kembali
							</a>
						</div>
						<div>
							<a
								href="{{ model_download_link }}"
								class="btn btn-success btn-sm"
								download>
								<i class="bx bx-download"></i>
								&nbsp; Unduh Model
							</a>
							<a
								href="{{ url_for('evaluation_model') }}"
								class="btn btn-primary btn-sm">
								<i class="bx bx-cog"></i>
								&nbsp; Evaluasi Model
							</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}
